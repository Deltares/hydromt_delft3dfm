
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Build a Delft3D FM 1D2D model from scratch &#8212; HydroMT Delft3D FM  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme-deltares.css?v=17060807" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_examples/build_1d2dmodel';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Updating a model" href="../user_guide/dflowfm_update.html" />
    <link rel="prev" title="Building a model" href="../user_guide/dflowfm_build.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/hydromt-logo.jpg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/hydromt-logo.jpg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">HydroMT Delft3D FM</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/intro.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../user_guide/intro.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../dev_guide/intro.html">
                        Developments
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://deltares.github.io/hydromt/latest/index.html">
                    HydroMT core
                  </a>
                </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/hydromt_delft3dfm" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" class="icon-link-image" alt="GitHub"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="for https://oss.deltares.nl/web/delft3dfm" title="Delft3D FM Suite" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/logo_delft3dfm.png" class="icon-link-image" alt="Delft3D FM Suite"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/deltares-blue.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/intro.html">
                        Getting started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../user_guide/intro.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../dev_guide/intro.html">
                        Developments
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://deltares.github.io/hydromt/latest/index.html">
                    HydroMT core
                  </a>
                </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Deltares/hydromt_delft3dfm" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" class="icon-link-image" alt="GitHub"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="for https://oss.deltares.nl/web/delft3dfm" title="Delft3D FM Suite" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/logo_delft3dfm.png" class="icon-link-image" alt="Delft3D FM Suite"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.deltares.nl/en/" title="Deltares" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/deltares-blue.svg" class="icon-link-image" alt="Deltares"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../user_guide/dflowfm.html">Working with the Delft3D FM model</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../user_guide/dflowfm_model_setup.html">Model methods and components</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../user_guide/dflowfm_build.html">Building a model</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Example: Build Delft3DFM 1D2D model</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user_guide/dflowfm_update.html">Updating a model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="update_refine_2dgrid.html">Example: Update Delft3DFM model (refine 2dgrid)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../user_guide/intro.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="../user_guide/dflowfm_build.html" class="nav-link">Building a model</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Build a...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Build-a-Delft3D-FM-1D2D-model-from-scratch">
<h1>Build a Delft3D FM 1D2D model from scratch<a class="headerlink" href="#Build-a-Delft3D-FM-1D2D-model-from-scratch" title="Link to this heading">#</a></h1>
<p>This notebook demonstrates how to prepare a <strong>1D2D Delft3D FM</strong> model from scratch using the command line interace (CLI).</p>
<p>We will combine elements that were prepared in the <em>Build 1D model</em> and <em>Build 2D model</em> notebooks, so we advise you to have a look at these before starting this one.</p>
<p>All lines in this notebook which start with <code class="docutils literal notranslate"><span class="pre">!</span></code> are executed from the command line. Within the notebook environment the logging messages are shown after completion. You can also copy these lines and paste these in your shell to get more direct feedback.</p>
<section id="HydroMT-CLI-build-interface">
<h2>HydroMT CLI build interface<a class="headerlink" href="#HydroMT-CLI-build-interface" title="Link to this heading">#</a></h2>
<p>Lets first check if the Delft3D FM model is recognized by HydroMT:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this should return &quot;dflowfm&quot; to build DFlowFM components of Delft3D FM</span>
<span class="c1"># as well as the generic HydroMT models &quot;grid_model, lumped_model, mesh_model, network_model&quot;</span>
<span class="o">!</span>hydromt<span class="w"> </span>--models
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
model plugins:
 - dflowfm (hydromt_delft3dfm 0.2.1.dev0)
generic models (hydromt 0.9.0):
 - grid_model
 - vector_model
 - mesh_model
 - network_model


</pre></div></div>
</div>
<p>Using the <strong>HydroMT build</strong> API we can setup a complete model from scratch. Letâ€™s get an overview of all the available options:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>hydromt<span class="w"> </span>build<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Usage: hydromt build [OPTIONS] MODEL MODEL_ROOT

  Build models from scratch.

  Example usage: --------------

  To build a wflow model for a subbasin using a point coordinates snapped to
  cells with upstream area &gt;= 50 km2 hydromt build wflow /path/to/model_root
  -i /path/to/wflow_config.ini  -r &#34;{&#39;subbasin&#39;: [-7.24, 62.09], &#39;uparea&#39;:
  50}&#34; -d deltares_data -d /path/to/data_catalog.yml -v

  To build a sfincs model based on a bbox hydromt build sfincs
  /path/to/model_root  -i /path/to/sfincs_config.ini  -r &#34;{&#39;bbox&#39;:
  [4.6891,52.9750,4.9576,53.1994]}&#34;  -d /path/to/data_catalog.yml -v

Options:
  --opt TEXT               Method specific keyword arguments, see the method
                           documentation of the specific model for more
                           information about the arguments.
  -i, --config PATH        Path to hydroMT configuration file, for the model
                           specific implementation.
  -r, --region TEXT        Set the region for which to build the model, e.g.
                           {&#39;subbasin&#39;: [-7.24, 62.09]}
  -d, --data TEXT          Path to local yaml data catalog file OR name of
                           predefined data catalog.
  --dd, --deltares-data    Flag: Shortcut to add the &#34;deltares_data&#34; catalog
  --fo, --force-overwrite  Flag: If provided overwrite existing model files
  --cache                  Flag: If provided cache tiled rasterdatasets
  -v, --verbose            Increase verbosity.
  -q, --quiet              Decrease verbosity.
  --help                   Show this message and exit.

</pre></div></div>
</div>
</section>
<section id="Data-for-model-setup">
<h2>Data for model setup<a class="headerlink" href="#Data-for-model-setup" title="Link to this heading">#</a></h2>
<p>Most of the time, the <code class="docutils literal notranslate"><span class="pre">&lt;...&gt;_fn</span></code> arguments correspond to a data source from the <code class="docutils literal notranslate"><span class="pre">DataCatalog</span></code> which is based on a yml-file with references to the data paths/urls and how the data should be read. This file can be provided to hydromt using <code class="docutils literal notranslate"><span class="pre">-d</span> <span class="pre">&lt;path_to_yml_file&gt;</span></code>.</p>
<p>By default, the pre-defined <code class="docutils literal notranslate"><span class="pre">artifact_data</span></code> catalog containing some example data for the Piave basin will be downloaded to <code class="docutils literal notranslate"><span class="pre">~/.hydromt_data/</span></code> which is also used for this example. An overview of the available example data is provided <a class="reference external" href="https://deltares.github.io/hydromt/latest/user_guide/data_existing_cat.html">here</a>. This example data is a based on the data which is available from the Deltares p-drive. If you have acces to this drive, a pre-configured catalog file can be loaded using the
<code class="docutils literal notranslate"><span class="pre">-d</span> <span class="pre">deltares_data</span></code> pre-defined catalog.</p>
<p>More information on how to write a data catalog yml file can be found in the <a class="reference external" href="https://deltares.github.io/hydromt/latest/user_guide/data_prepare_cat.html">HydroMT core docs</a></p>
<blockquote>
<div><p><strong>NOTE</strong>: In HydroMT-Delft3D FM, an additionnal data catalog with all default parameters values is always used <a class="reference external" href="https://github.com/Deltares/hydromt_delft3dfm/tree/main/hydromt_delft3dfm/data/parameters_data.yml">parameters_data.yml</a>. It contains default values for 1D network elements and structures as well as default 2D landuse paramter mapping tables.</p>
</div></blockquote>
</section>
<section id="Model-setup-configuration">
<h2>Model setup configuration<a class="headerlink" href="#Model-setup-configuration" title="Link to this heading">#</a></h2>
<p>The HydroMT configuration file contains the model setup configuration and determines which methods are used to prepare the different components of a Delft3D FM model and in which order and optionally sets non-default arguments for each method. This configuration is passed to HydroMT using <code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">&lt;path_to_configuration_file&gt;</span></code>. The supported format are either YAML or INI. We have prepared several example yml-files which are available in the model repository <a class="reference external" href="https://github.com/Deltares/hydromt_delft3dfm/tree/main/examples">examples
folder</a> and from the <a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/user_guide/dflowfm_build">docs (building a model)</a>.</p>
<p>Each section, before indent, (e.g. setup_rivers_from_dem) corresponds to a model method. All model methods are explained in the <a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/user_guide/dflowfm_model_setup.html">docs (model components)</a>. The <code class="docutils literal notranslate"><span class="pre">global</span></code> section contains direct model initialisation properties.</p>
<p>We will load the default dflowfm build 1D2D yaml file for inspection:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fn_yml</span> <span class="o">=</span> <span class="s2">&quot;dflowfm_build.yml&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn_yml</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
global:
  crs: 3857
  network_snap_offset: 25
  openwater_computation_node_distance: 40

setup_rivers_from_dem:
  region:
    bbox: [12.4331, 46.4661, 12.5212, 46.5369]
  hydrography_fn: merit_hydro
  river_geom_fn: rivers_lin2019_v1
  rivers_defaults_fn: rivers_defaults
  rivdph_method: gvf
  rivwth_method: geom
  river_upa: 25.0
  friction_type: &#34;Manning&#34;
  friction_value: 0.023
  rivbankq: 25

setup_pipes:
  region:
    bbox: [12.4331, 46.4661, 12.5212, 46.5369]
  pipes_fn: grip_roads
  pipes_defaults_fn: pipes_defaults
  pipe_filter: pipe
  spacing: 50
  friction_type: WhiteColeBrook
  friction_value: 0.003
  crosssections_shape: circle
  crosssections_value: 0.5
  dem_fn: merit_hydro # [copdem30, merit]
  pipes_depth: 2.0
  snap_offset: 0.5
  pipes_invlev: 3.

setup_manholes:
  manholes_fn:
  manhole_defaults_fn: manholes_defaults
  dem_fn: merit_hydro
  bedlevel_shift: 0.5

setup_1dboundary:
  boundary_value: -2.0
  branch_type: river
  boundary_type: waterlevel
  boundary_unit: m
  boundary_locs: both

setup_mesh2d:
  region:
    bbox: [12.4331, 46.4661, 12.5212, 46.5369]
  res: 500

setup_maps_from_rasterdataset:
  raster_fn: merit_hydro
  variables: [&#34;elevtn&#34;]
  fill_method: nearest
  interpolation_method: nearestNb

setup_maps_from_raster_reclass:
  raster_fn: vito
  reclass_table_fn: vito_mapping
  reclass_variables: [&#39;roughness_manning&#39;, &#39;infiltcap&#39;]
  interpolation_method: triangulation

setup_rainfall_from_constant:
  constant_value: 150

setup_link1d2d:
  link_direction: 1d_to_2d
</pre></div></div>
</div>
<p>Looking at this file, you see that we will prepare the following information for our model:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.html#hydromt_delft3dfm.DFlowFMModel">global</a>: Our model will be defined in the projected CRS WGS84 EPSG 3857. TO ensure the 1D network is connected, we will allow snapping of 25 meters using argument network_snap_offset. The 1D computational grid for the open water system will be created at 40 meters distance using argument openwater_computation_node_distance.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_rivers_from_dem.html">setup_rivers_from_dem</a>: We will derive the 1D rivers lines based on the <em>MERIT Hydro DEM</em> and that intersects with the region bounding box [12.4331, 46.4661, 12.5212, 46.5369]. River roughness will be a Manning constant of 25.0 and we will use data from <em>rivers_lin2019</em> database to prepare rectangular cross-sections.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_pipes.html">setup_pipes</a>: We will add pipes by assuming that they are located under the roads, with a standard length of 50 meters. The roads are defined in the <em>grip_roads</em> data and the standard length are defined in the argument spacing. Roughness will be a WhiteColeBrook constant of 0.003 and we will use a circular cross-sections of 0.5m. The pipes invert levels will be derived from the
<em>MERIT Hydro DEM</em> assuming a constant depth of the pipe underground of 2 meters.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_manholes.html">setup_manholes</a>: For a pipe network, manholes are present at pipe connections. Here we do not have specific input data locations for our pipes, so manholes will be generated based on a set of standards specified in manhole_defaults_fn.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_1dboundary.html">setup_1dboundary</a>: Finally as a default, we will apply both upstream and downstream boundaries of our rivers with a constant waterlevel of -2.0 meter a.s.l</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_mesh2d.html">setup_mesh2d</a>: we will prepare a regular grid for the region bounding box [12.4331, 46.4661, 12.5212, 46.5369] of <em>500</em>**500* meters resolution.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_maps_from_rasterdataset.html">setup_maps_from_rasterdataset</a>: prepares gridded elevation (bedlevel) from <em>merit_hydro</em>. Here elevation is extracted from <em>merit_hydro</em> and any no data is filled using <em>nearest</em> method. When running, the Delft3D FM kernel will interpolate it to the mesh 2D grid using the <em>nearestNb</em> method.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_maps_from_raster_reclass.html">setup_maps_from_raster_reclass</a>: prepares gridded Manning roughness and infiltration capacity data from landuse, by reclassifying the landuse categories in <em>vito</em> landuse data, using parameters values defined per landuse category in <em>vito_mapping</em> table. When running, the Delft3D FM kernel will interpolate it to the mesh 2D grid using the <em>triangulation</em>
method.</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_rainfall_from_constant.html">setup_rainfall_from_constant</a>: prepares a constant rainfall rate of <em>150</em> mm/day as meteo forcing to the model. Feel free to use the links of each components to know more about how each function works and what are all the available settings. Additionnally to a 1D or 2D models only, we have now added a new method:</p></li>
<li><p><a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_generated/hydromt_delft3dfm.DFlowFMModel.setup_link1d2d.html">setup_link1d2d</a>: we will link our 1D and 2D mesh by setting up links from the 1D network to the 2D grid. As you can imagine, this function can only be run once both the schematisation of the 1D and the 2D grids are finalized. If any change is made to the 1D or the 2D grid, this funcion should be run again.</p></li>
</ul>
<p>Feel free to use the links of each components to know more about how each function works and what are all the available settings.</p>
<blockquote>
<div><p><strong>NOTE</strong>: In this example, we apply region argument in setup_rivers_from_dem, setup_pipes and setup_mesh2d. They are identical in this example but one can alter them to have different region for rivers, for pipes and for 2dmesh. This allows the user to customize their model as much as possible, as the extent of the 1D river can differ from the extent of the 1D urban network or the 2D inundation grid. The region bbox are in WGS 84 as required, but the user should specify the dflowfm model
destination CRS in the <code class="docutils literal notranslate"><span class="pre">global</span></code> section in order to allow to use grid definition data (rivers, pipes) from different data sources or CRS.</p>
</div></blockquote>
</section>
<section id="Building-a-1D2D-Delft3D-FM-model">
<h2>Building a 1D2D Delft3D FM model<a class="headerlink" href="#Building-a-1D2D-Delft3D-FM-model" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: copy this line (without !) to your shell for more direct feedback - should take about 1 minute or 2 to run</span>
<span class="o">!</span>hydromt<span class="w"> </span>build<span class="w"> </span>dflowfm<span class="w"> </span><span class="s2">&quot;./build/dflowfm_1d2d&quot;</span><span class="w"> </span>-i<span class="w"> </span>dflowfm_build.yml<span class="w"> </span>-d<span class="w"> </span>artifact_data<span class="w"> </span>--fo<span class="w"> </span>-vv
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-11-28 15:10:54,940 - build - log - DEBUG - Writing log messages to new file /home/runner/work/hydromt_delft3dfm/hydromt_delft3dfm/docs/_examples/build/dflowfm_1d2d/hydromt.log.
2023-11-28 15:10:54,940 - build - log - INFO - HydroMT version: 0.9.0
2023-11-28 15:10:54,940 - build - main - INFO - Building instance of dflowfm model at /home/runner/work/hydromt_delft3dfm/hydromt_delft3dfm/docs/_examples/build/dflowfm_1d2d.
2023-11-28 15:10:54,940 - build - main - INFO - User settings:
2023-11-28 15:10:55,601 - build - data_catalog - INFO - Reading data catalog archive artifact_data v0.0.8
2023-11-28 15:10:55,601 - build - data_catalog - DEBUG - Caching data from https://github.com/DirkEilander/hydromt-artifacts/releases/download/v0.0.8/data.tar.gz
2023-11-28 15:10:56,441 - build - data_catalog - DEBUG - Unpacking data from https://github.com/DirkEilander/hydromt-artifacts/releases/download/v0.0.8/data.tar.gz
2023-11-28 15:10:57,203 - build - data_catalog - INFO - Parsing data catalog from /home/runner/.hydromt_data/artifact_data/v0.0.8/data_catalog.yml
2023-11-28 15:10:57,263 - build - model_api - INFO - Initializing dflowfm model from hydromt_delft3dfm (v0.2.1.dev0).
2023-11-28 15:10:57,264 - build - data_catalog - INFO - Parsing data catalog from /usr/share/miniconda3/envs/hydromt-delft3dfm/lib/python3.9/site-packages/hydromt_delft3dfm/data/parameters_data.yml
2023-11-28 15:10:57,269 - build - dflowfm - INFO - Initialising empty mdu file
2023-11-28 15:10:57,274 - build - dflowfm - INFO - project crs: 3857
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.region: {&#39;bbox&#39;: [12.4331, 46.4661, 12.5212, 46.5369]}
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.hydrography_fn: merit_hydro
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.river_geom_fn: rivers_lin2019_v1
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.rivers_defaults_fn: rivers_defaults
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.rivdph_method: gvf
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.rivwth_method: geom
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.river_upa: 25.0
2023-11-28 15:10:57,274 - build - model_api - INFO - setup_rivers_from_dem.river_len: 1000
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.min_rivwth: 50.0
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.min_rivdph: 1.0
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.rivbank: True
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.rivbankq: 25
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.segment_length: 3000.0
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.smooth_length: 10000.0
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.friction_type: Manning
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.friction_value: 0.023
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.constrain_rivbed: True
2023-11-28 15:10:57,275 - build - model_api - INFO - setup_rivers_from_dem.constrain_estuary: True
2023-11-28 15:10:57,275 - build - dflowfm - INFO - Preparing river shape from hydrography data.
2023-11-28 15:10:57,282 - build - rasterdataset - INFO - Reading merit_hydro raster data from /home/runner/.hydromt_data/artifact_data/v0.0.8/merit_hydro/{variable}.tif
2023-11-28 15:10:57,394 - build - rasterdataset - DEBUG - Clip to [12.433, 46.466, 12.521, 46.537] (epsg:4326))
2023-11-28 15:10:57,396 - build - geodataframe - INFO - Reading rivers_lin2019_v1 vector data from /home/runner/.hydromt_data/artifact_data/v0.0.8/rivers_lin2019_v1.gpkg
2023-11-28 15:10:57,426 - build - geodataframe - DEBUG - Clip intersects [1384045.361, 5855358.290, 1393854.608, 5866810.259] (EPSG:3857)
2023-11-28 15:11:04,827 - build - dem - INFO - Deriving bankfull river surface elevation from its banks.
2023-11-28 15:11:11,251 - build - dem - INFO - Smoothing river width (n=2).
2023-11-28 15:11:12,917 - build - dataframe - INFO - Reading rivers_defaults csv data from /usr/share/miniconda3/envs/hydromt-delft3dfm/lib/python3.9/site-packages/hydromt_delft3dfm/data/branches/rivers_defaults.csv
2023-11-28 15:11:12,929 - build - branches - INFO - Processing branches
2023-11-28 15:11:12,929 - build - branches - DEBUG - Cleaning up branches
2023-11-28 15:11:12,934 - build - branches - DEBUG - Exploding branches.
2023-11-28 15:11:12,936 - build - branches - DEBUG - Removing 0 branches which have duplicated geometry.
2023-11-28 15:11:12,937 - build - branches - DEBUG - Removing 1 branches that are shorter than 0.1 meter.
2023-11-28 15:11:12,941 - build - branches - DEBUG - Renaming 0 id_col duplicates. Convention:BRANCH_1, BRANCH_1 --&gt; BRANCH_1, BRANCH_1-2.
2023-11-28 15:11:12,948 - build - branches - DEBUG - Reducing precision of the GeoDataFrame.Rounding precision (e-6) .
2023-11-28 15:11:12,950 - build - branches - DEBUG - Performing snapping at all branch ends, excluding intersections(To avoid messy results, please use a lower snap_offset)..
2023-11-28 15:11:12,951 - build - branches - DEBUG - Splitting branches based on spacing
2023-11-28 15:11:12,953 - build - branches - DEBUG - clipping branches into 5 segments
2023-11-28 15:11:12,954 - build - branches - DEBUG - Generating branchnodes
2023-11-28 15:11:12,960 - build - branches - INFO - Validating branches
2023-11-28 15:11:12,962 - build - crosssections - INFO - Adding/Filling branches attributes values
2023-11-28 15:11:12,965 - build - dflowfm - INFO - Preparing crossections from branch.
2023-11-28 15:11:12,976 - build - dflowfm - DEBUG - Adding crosssections vector to geoms.
2023-11-28 15:11:12,976 - build - dflowfm - DEBUG - Adding rivers and river_nodes vector to geoms.
2023-11-28 15:11:12,981 - build - model_api - WARNING - Replacing geom: rivers
2023-11-28 15:11:12,983 - build - dflowfm - DEBUG - Adding branches vector to geoms.
2023-11-28 15:11:12,983 - build - dflowfm - DEBUG - Updating branches in network.
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.region: {&#39;bbox&#39;: [12.4331, 46.4661, 12.5212, 46.5369]}
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.pipes_fn: grip_roads
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.pipes_defaults_fn: pipes_defaults
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.pipe_filter: pipe
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.spacing: 50
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.friction_type: WhiteColeBrook
2023-11-28 15:11:13,071 - build - model_api - INFO - setup_pipes.friction_value: 0.003
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.crosssections_shape: circle
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.crosssections_value: 0.5
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.dem_fn: merit_hydro
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.pipes_depth: 2.0
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.pipes_invlev: 3.0
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.snap_offset: 0.5
2023-11-28 15:11:13,072 - build - model_api - INFO - setup_pipes.allow_intersection_snapping: True
2023-11-28 15:11:13,072 - build - dflowfm - INFO - Preparing 1D pipes.
2023-11-28 15:11:13,076 - build - geodataframe - INFO - Reading grip_roads vector data from /home/runner/.hydromt_data/artifact_data/v0.0.8/grip_roads.gpkg
2023-11-28 15:11:13,093 - build - geodataframe - DEBUG - Clip intersects [1384046.361, 5855359.290, 1393853.608, 5866809.259] (EPSG:3857)
2023-11-28 15:11:13,095 - build - dataframe - INFO - Reading pipes_defaults csv data from /usr/share/miniconda3/envs/hydromt-delft3dfm/lib/python3.9/site-packages/hydromt_delft3dfm/data/branches/pipes_defaults.csv
2023-11-28 15:11:13,102 - build - branches - INFO - Processing branches
2023-11-28 15:11:13,104 - build - branches - DEBUG - Cleaning up branches
2023-11-28 15:11:13,111 - build - branches - DEBUG - Exploding branches.
2023-11-28 15:11:13,113 - build - branches - DEBUG - Removing 0 branches which have duplicated geometry.
2023-11-28 15:11:13,114 - build - branches - DEBUG - Removing 0 branches that are shorter than 0.1 meter.
2023-11-28 15:11:13,128 - build - branches - DEBUG - Renaming 0 id_col duplicates. Convention:BRANCH_1, BRANCH_1 --&gt; BRANCH_1, BRANCH_1-2.
2023-11-28 15:11:13,172 - build - branches - DEBUG - Reducing precision of the GeoDataFrame.Rounding precision (e-6) .
2023-11-28 15:11:13,177 - build - branches - DEBUG - Performing snapping at all branch ends, including intersections(To avoid messy results, please use a lower snap_offset).
2023-11-28 15:11:13,178 - build - branches - DEBUG - Splitting branches based on spacing
2023-11-28 15:11:15,175 - build - branches - DEBUG - clipping branches into 2826 segments
2023-11-28 15:11:15,176 - build - branches - DEBUG - Generating branchnodes
2023-11-28 15:11:15,601 - build - branches - INFO - Validating branches
2023-11-28 15:11:15,605 - build - crosssections - INFO - Adding/Filling branches attributes values
2023-11-28 15:11:15,623 - build - dflowfm - INFO - grip_roads does not have columns [invlev_up, invlev_dn].Invert levels will be generated from dem_fn ordefault value 3.0
2023-11-28 15:11:15,624 - build - rasterdataset - INFO - Reading merit_hydro raster data from /home/runner/.hydromt_data/artifact_data/v0.0.8/merit_hydro/{variable}.tif
2023-11-28 15:11:15,639 - build - rasterdataset - DEBUG - Clip to [12.433, 46.466, 12.521, 46.537] (epsg:4326))
2023-11-28 15:11:15,963 - build - dflowfm - INFO - Preparing crossections from branch.
2023-11-28 15:11:16,035 - build - dflowfm - DEBUG - Adding crosssections vector to geoms.
2023-11-28 15:11:16,057 - build - model_api - WARNING - Replacing geom: crosssections
2023-11-28 15:11:16,058 - build - dflowfm - DEBUG - Adding pipes and pipe_nodes vector to geoms.
2023-11-28 15:11:16,540 - build - model_api - WARNING - Replacing geom: rivers
2023-11-28 15:11:16,542 - build - model_api - WARNING - Replacing geom: pipes
2023-11-28 15:11:16,542 - build - dflowfm - DEBUG - Adding branches vector to geoms.
2023-11-28 15:11:16,542 - build - model_api - WARNING - Replacing geom: branches
2023-11-28 15:11:16,542 - build - dflowfm - DEBUG - Updating branches in network.
2023-11-28 15:11:17,478 - build - model_mesh - WARNING - Overwriting grid network1d and the corresponding data variables in mesh.
2023-11-28 15:11:17,541 - build - model_mesh - WARNING - Overwriting grid mesh1d and the corresponding data variables in mesh.
2023-11-28 15:11:17,786 - build - model_api - WARNING - Replacing geom: boundaries
2023-11-28 15:11:17,786 - build - model_api - INFO - setup_manholes.manholes_fn: None
2023-11-28 15:11:17,787 - build - model_api - INFO - setup_manholes.manhole_defaults_fn: manholes_defaults
2023-11-28 15:11:17,787 - build - model_api - INFO - setup_manholes.bedlevel_shift: 0.5
2023-11-28 15:11:17,787 - build - model_api - INFO - setup_manholes.dem_fn: merit_hydro
2023-11-28 15:11:17,787 - build - model_api - INFO - setup_manholes.snap_offset: 0.001
2023-11-28 15:11:17,787 - build - dflowfm - INFO - generating manholes locations and bedlevels.
2023-11-28 15:11:17,787 - build - manholes - INFO - Generating manholes on pipes and/or tunnels
2023-11-28 15:11:18,025 - build - manholes - INFO - Shifting manholes bedlevels based on bedlevel_shift = 0.5
2023-11-28 15:11:18,214 - build - model_api - WARNING - Replacing geom: rivers
2023-11-28 15:11:18,216 - build - model_api - WARNING - Replacing geom: pipes
2023-11-28 15:11:18,217 - build - dflowfm - DEBUG - Adding branches vector to geoms.
2023-11-28 15:11:18,217 - build - model_api - WARNING - Replacing geom: branches
2023-11-28 15:11:18,217 - build - dflowfm - DEBUG - Updating branches in network.
2023-11-28 15:11:18,217 - build - dataframe - INFO - Reading manholes_defaults csv data from /usr/share/miniconda3/envs/hydromt-delft3dfm/lib/python3.9/site-packages/hydromt_delft3dfm/data/storages/manholes_defaults.csv
2023-11-28 15:11:18,227 - build - dflowfm - INFO - overwriting manholes street level from dem.
2023-11-28 15:11:18,227 - build - rasterdataset - INFO - Reading merit_hydro raster data from /home/runner/.hydromt_data/artifact_data/v0.0.8/merit_hydro/{variable}.tif
2023-11-28 15:11:18,242 - build - rasterdataset - DEBUG - Clip to [12.433, 46.466, 12.521, 46.537] (epsg:4326))
2023-11-28 15:11:18,259 - build - dflowfm - DEBUG - street level mean is 863.6583862304688
2023-11-28 15:11:18,259 - build - dflowfm - DEBUG - dropping duplicated manholeid
2023-11-28 15:11:18,317 - build - dflowfm - DEBUG - Adding manholes vector to geoms.
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundaries_geodataset_fn: None
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundaries_timeseries_fn: None
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundary_value: -2.0
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.branch_type: river
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundary_type: waterlevel
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundary_unit: m
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.boundary_locs: both
2023-11-28 15:11:18,318 - build - model_api - INFO - setup_1dboundary.snap_offset: 1.0
2023-11-28 15:11:18,318 - build - dflowfm - INFO - Preparing 1D waterlevel boundaries for river.
2023-11-28 15:11:18,319 - build - boundaries - INFO - Using constant value -2.0 mfor all waterlevel boundaries.
2023-11-28 15:11:18,320 - build - model_api - INFO - setup_mesh2d.region: {&#39;bbox&#39;: [12.4331, 46.4661, 12.5212, 46.5369]}
2023-11-28 15:11:18,321 - build - model_api - INFO - setup_mesh2d.res: 500
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.raster_fn: merit_hydro
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.variables: [&#39;elevtn&#39;]
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.fill_method: nearest
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.reproject_method: nearest
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.interpolation_method: nearestNb
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.locationtype: 2d
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.name: None
2023-11-28 15:11:18,370 - build - model_api - INFO - setup_maps_from_rasterdataset.split_dataset: True
2023-11-28 15:11:18,370 - build - model_api - INFO - Preparing maps data from raster source merit_hydro
2023-11-28 15:11:18,371 - build - rasterdataset - INFO - Reading merit_hydro raster data from /home/runner/.hydromt_data/artifact_data/v0.0.8/merit_hydro/{variable}.tif
2023-11-28 15:11:18,385 - build - rasterdataset - DEBUG - Clip to [12.433, 46.466, 12.523, 46.538] (epsg:4326))
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.raster_fn: vito
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.reclass_table_fn: vito_mapping
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.reclass_variables: [&#39;roughness_manning&#39;, &#39;infiltcap&#39;]
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.fill_method: None
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.reproject_method: nearest
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.interpolation_method: triangulation
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.locationtype: 2d
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.name: None
2023-11-28 15:11:18,407 - build - model_api - INFO - setup_maps_from_raster_reclass.split_dataset: True
2023-11-28 15:11:18,407 - build - model_api - INFO - Preparing map data by reclassifying the data in vito based on vito_mapping
2023-11-28 15:11:18,407 - build - rasterdataset - INFO - Reading vito raster data from /home/runner/.hydromt_data/artifact_data/v0.0.8/vito.tif
2023-11-28 15:11:18,421 - build - rasterdataset - DEBUG - Clip to [12.433, 46.466, 12.523, 46.538] (epsg:4326))
2023-11-28 15:11:18,422 - build - dataframe - INFO - Reading vito_mapping csv data from /usr/share/miniconda3/envs/hydromt-delft3dfm/lib/python3.9/site-packages/hydromt_delft3dfm/data/landuse/vito_mapping.csv
The nodata value None is not in the reclass table.None will be used for the params.
2023-11-28 15:11:18,455 - build - model_api - INFO - setup_rainfall_from_constant.constant_value: 150
2023-11-28 15:11:18,455 - build - dflowfm - INFO - Preparing rainfall meteo forcing from uniform timeseries.
2023-11-28 15:11:18,456 - build - boundaries - INFO - Preparing global (spatially uniform) timeseries.
2023-11-28 15:11:18,456 - build - boundaries - WARNING - time unit days is not supported by the current GUI version: 2022.04
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.link_direction: 1d_to_2d
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.link_type: embedded
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.polygon_fn: None
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.branch_type: None
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.max_length: inf
2023-11-28 15:11:18,458 - build - model_api - INFO - setup_link1d2d.dist_factor: 2.0
2023-11-28 15:11:18,458 - build - dflowfm - WARNING - adding 1d2d links for all branches at non boundary locations.
2023-11-28 15:11:18,458 - build - dflowfm - INFO - setting up 1d_to_2d links.
2023-11-28 15:11:18,630 - build - dflowfm - INFO - Writing model data to /home/runner/work/hydromt_delft3dfm/hydromt_delft3dfm/docs/_examples/build/dflowfm_1d2d
2023-11-28 15:11:18,630 - build - dflowfm - INFO - Writing maps files to /home/runner/work/hydromt_delft3dfm/hydromt_delft3dfm/docs/_examples/build/dflowfm_1d2d/maps
2023-11-28 15:11:18,707 - build - model_api - DEBUG - Writing file geoms/crosssections.geojson
2023-11-28 15:11:18,968 - build - model_api - DEBUG - Writing file geoms/rivers.geojson
2023-11-28 15:11:18,978 - build - model_api - DEBUG - Writing file geoms/rivers_nodes.geojson
2023-11-28 15:11:18,985 - build - model_api - DEBUG - Writing file geoms/branches.geojson
2023-11-28 15:11:19,167 - build - model_api - DEBUG - Writing file geoms/boundaries.geojson
2023-11-28 15:11:19,181 - build - model_api - DEBUG - Writing file geoms/pipes.geojson
2023-11-28 15:11:19,360 - build - model_api - DEBUG - Writing file geoms/pipe_nodes.geojson
2023-11-28 15:11:19,587 - build - model_api - DEBUG - Writing file geoms/manholes.geojson
2023-11-28 15:11:19,729 - build - model_api - DEBUG - Writing file geoms/region.geojson
2023-11-28 15:11:19,733 - build - model_api - DEBUG - Writing file geoms/network1d.geojson
2023-11-28 15:11:19,802 - build - model_api - DEBUG - Writing file geoms/mesh2d.geojson
2023-11-28 15:11:19,872 - build - model_api - DEBUG - Writing file geoms/mesh1d.geojson
2023-11-28 15:11:19,985 - build - dflowfm - INFO - Writting cross-sections files crsdef and crsloc
2023-11-28 15:11:20,382 - build - dflowfm - INFO - Writting friction file(s)
2023-11-28 15:11:20,387 - build - dflowfm - INFO - Writting manholes file.
2023-11-28 15:11:20,824 - build - model_api - WARNING - Replacing geom: network1d
2023-11-28 15:11:20,824 - build - model_api - WARNING - Replacing geom: mesh2d
2023-11-28 15:11:20,824 - build - model_api - WARNING - Replacing geom: mesh1d
2023-11-28 15:11:20,835 - build - model_api - WARNING - Replacing geom: crosssections
2023-11-28 15:11:20,838 - build - model_api - WARNING - Replacing geom: rivers
2023-11-28 15:11:20,839 - build - model_api - WARNING - Replacing geom: rivers_nodes
2023-11-28 15:11:20,847 - build - model_api - WARNING - Replacing geom: branches
2023-11-28 15:11:20,850 - build - model_api - WARNING - Replacing geom: boundaries
2023-11-28 15:11:20,859 - build - model_api - WARNING - Replacing geom: pipes
2023-11-28 15:11:20,865 - build - model_api - WARNING - Replacing geom: pipe_nodes
2023-11-28 15:11:20,872 - build - model_api - WARNING - Replacing geom: manholes
2023-11-28 15:11:20,872 - build - model_api - WARNING - Replacing geom: region
2023-11-28 15:11:20,873 - build - model_api - WARNING - Replacing geom: network1d
2023-11-28 15:11:20,873 - build - model_api - WARNING - Replacing geom: mesh2d
2023-11-28 15:11:20,874 - build - model_api - WARNING - Replacing geom: mesh1d
2023-11-28 15:11:20,874 - build - model_api - DEBUG - Writing file geoms/crosssections.geojson
2023-11-28 15:11:21,144 - build - model_api - DEBUG - Writing file geoms/rivers.geojson
2023-11-28 15:11:21,155 - build - model_api - DEBUG - Writing file geoms/rivers_nodes.geojson
2023-11-28 15:11:21,163 - build - model_api - DEBUG - Writing file geoms/branches.geojson
2023-11-28 15:11:21,346 - build - model_api - DEBUG - Writing file geoms/boundaries.geojson
2023-11-28 15:11:21,358 - build - model_api - DEBUG - Writing file geoms/pipes.geojson
2023-11-28 15:11:21,537 - build - model_api - DEBUG - Writing file geoms/pipe_nodes.geojson
2023-11-28 15:11:21,769 - build - model_api - DEBUG - Writing file geoms/manholes.geojson
2023-11-28 15:11:21,910 - build - model_api - DEBUG - Writing file geoms/region.geojson
2023-11-28 15:11:21,915 - build - model_api - DEBUG - Writing file geoms/network1d.geojson
2023-11-28 15:11:21,983 - build - model_api - DEBUG - Writing file geoms/mesh2d.geojson
2023-11-28 15:11:22,054 - build - model_api - DEBUG - Writing file geoms/mesh1d.geojson
2023-11-28 15:11:22,449 - build - dflowfm - INFO - Writting branches.gui file
2023-11-28 15:11:22,597 - build - dflowfm - INFO - Writting forcing files.
2023-11-28 15:11:23,747 - build - dflowfm - INFO - Initialising empty dimr file
2023-11-28 15:11:23,747 - build - dflowfm - INFO - Adding dflowfm component to dimr config
2023-11-28 15:11:23,747 - build - dflowfm - INFO - Writing model dimr file to /home/runner/work/hydromt_delft3dfm/hydromt_delft3dfm/docs/_examples/build/dflowfm_1d2d/dimr_config.xml

</pre></div></div>
</div>
<p>The example above means the following: run <strong>hydromt build</strong> with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dflowfm</span></code> : i.e. build a FM model</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">./build/dflowfm_1d2d</span></code> : output model folder</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">dflowfm_build.yml</span></code>: model build configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-d</span> <span class="pre">artifact_data</span></code>: data catalog to use. Here the default artifact data catalog with global data for Northern Italy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--fo</span></code>: force overwritting in case a model already exists in the output folder.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-vv</span></code> : give some extra verbosity (2 * v) to display feedback on screen. Now debug and info messages are provided rather than only warnings and errors.</p></li>
</ul>
<blockquote>
<div><p>NOTE: You can use as many data catalogs as you need within the same command line, by repeating the <code class="docutils literal notranslate"><span class="pre">-d</span></code> options and name of the catalog to use several times.</p>
</div></blockquote>
<p>Next we check which files have been created.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;./build/dflowfm_1d2d/&quot;</span>
<span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
./build/dflowfm_1d2d/
 - hydromt.log
 - dimr_config.xml
 - hydromt_data.yml
./build/dflowfm_1d2d/geoms
 - branches.geojson
 - boundaries.geojson
 - region.geojson
 - pipes.geojson
 - manholes.geojson
 - mesh1d.geojson
 - network1d.geojson
 - pipe_nodes.geojson
 - mesh2d.geojson
 - rivers.geojson
 - crosssections.geojson
 - rivers_nodes.geojson
./build/dflowfm_1d2d/dflowfm
 - DFlowFM.mdu
 - bnd.ext
 - roughness_WhiteColeBrook_0.003.ini
 - crsdef.ini
 - crsloc.ini
 - boundarycondition1d.bc
 - fm_net.nc
 - fieldFile.ini
 - branches.gui
 - nodeFile.ini
 - roughness_Manning_0.023.ini
 - meteo_boundaryconditions.bc
./build/dflowfm_1d2d/maps
 - InfiltrationCapacity.tif
 - bedlevel.tif
 - frictioncoefficient.tif
</pre></div></div>
</div>
<p>The model root should contain three files and four folders:</p>
<ul class="simple">
<li><p>dimr_config.xml: Configuration file to execute Delft3D FM in Deltares Integrated Model Runner (DIMR).</p></li>
<li><p>hydromt.log: log saved by HydroMT on model building steps.</p></li>
<li><p>hydromt_data.yml: information saved by HydroMT on used datasets for reproducibility.</p></li>
<li><p><strong>dflowfm</strong> folder: dflowfm files, here for our 2D model. Contains all necessary information to run a 2D model including the mesh2d, and settings and paths to the mesh2d data files in the maps folder. The configuration MDU file is also created.</p></li>
<li><p><strong>geoms</strong> folder: folder containing a copy of the dflowfm data in an easily readable GIS format rather than the ini or UGRID netcdf file.</p></li>
<li><p><strong>maps</strong> folder: folder containing regular gridded data that Delft3D FM can interpolate to the 2D mesh grid. Here we see our elevation or bedlevel data, as well as the roughness / friction and infiltration capacity maps.</p></li>
</ul>
</section>
<section id="Visualize-and/or-inspect-model-schematization">
<h2>Visualize and/or inspect model schematization<a class="headerlink" href="#Visualize-and/or-inspect-model-schematization" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We can now load the <strong>dimr_config.xml</strong> into <strong>Delft3D FM GUI</strong>.</p></li>
<li><p>The <strong>dflowfm plot</strong> <a class="reference external" href="https://deltares.github.io/hydromt_delft3dfm/latest/_examples/plot_dflowfm_mesh.html">example notebook</a> contains scripts to visualize your model in python:</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../user_guide/dflowfm_build.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Building a model</p>
      </div>
    </a>
    <a class="right-next"
       href="../user_guide/dflowfm_update.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Updating a model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#HydroMT-CLI-build-interface">HydroMT CLI build interface</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Data-for-model-setup">Data for model setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Model-setup-configuration">Model setup configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Building-a-1D2D-Delft3D-FM-model">Building a 1D2D Delft3D FM model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Visualize-and/or-inspect-model-schematization">Visualize and/or inspect model schematization</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/Deltares/hydromt_delft3dfm/edit/main/docs/_examples/build_1d2dmodel.ipynb">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/_examples/build_1d2dmodel.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright Deltares.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>